<div hidden="" by-polymer-bundler=""><link rel="import" href="../distribution-app.html"><script>var _Mathsqrt=Math.sqrt,_Mathpow=Math.pow;this.j$=this.jStat=function(v,w){function x(K,L){var M=K>L?K:L;return v.pow(10,17-~~(v.log(0<M?M:-M)*v.LOG10E))}function y(K){return"[object Function]"===H.call(K)}function z(K){return"number"==typeof K&&K===K}function B(){return new B._init(arguments)}function C(){return 0}function D(){return 1}function E(K,L){return K===L?1:0}var F=Array.prototype.concat,G=Array.prototype.slice,H=Object.prototype.toString,I=Array.isArray||function(K){return"[object Array]"===H.call(K)};B.fn=B.prototype,B._init=function(K){var L;if(I(K[0])){if(I(K[0][0])){y(K[1])&&(K[0]=B.map(K[0],K[1]));for(var L=0;L<K[0].length;L++)this[L]=K[0][L];this.length=K[0].length}else this[0]=y(K[1])?B.map(K[0],K[1]):K[0],this.length=1;}else if(z(K[0]))this[0]=B.seq.apply(null,K),this.length=1;else{if(K[0]instanceof B)return B(K[0].toArray());this[0]=[],this.length=1}return this},B._init.prototype=B.prototype,B._init.constructor=B,B.utils={calcRdx:x,isArray:I,isFunction:y,isNumber:z,toVector:function(K){return F.apply([],K)}},B.extend=function(K){var L,M;if(1===arguments.length){for(M in K)B[M]=K[M];return this}for(var L=1;L<arguments.length;L++)for(M in arguments[L])K[M]=arguments[L][M];return K},B.rows=function(K){return K.length||1},B.cols=function(K){return K[0].length||1},B.dimensions=function(K){return{rows:B.rows(K),cols:B.cols(K)}},B.row=function(K,L){return I(L)?L.map(function(M){return B.row(K,M)}):K[L]},B.rowa=function(K,L){return B.row(K,L)},B.col=function(K,L){if(I(L)){var M=B.arange(K.length).map(function(){return Array(L.length)});return L.forEach(function(P,Q){B.arange(K.length).forEach(function(R){M[R][Q]=K[R][P]})}),M}for(var N=Array(K.length),O=0;O<K.length;O++)N[O]=[K[O][L]];return N},B.cola=function(K,L){return B.col(K,L).map(function(M){return M[0]})},B.diag=function(K){for(var L=B.rows(K),M=Array(L),N=0;N<L;N++)M[N]=[K[N][N]];return M},B.antidiag=function(K){for(var L=B.rows(K)-1,M=Array(L),N=0;0<=L;L--,N++)M[N]=[K[N][L]];return M},B.transpose=function(K){var M,N,O,P,Q,L=[];I(K[0])||(K=[K]),N=K.length,O=K[0].length;for(var Q=0;Q<O;Q++){for(M=Array(N),P=0;P<N;P++)M[P]=K[P][Q];L.push(M)}return 1===L.length?L[0]:L},B.map=function(K,L,M){var N,O,P,Q,R;for(I(K[0])||(K=[K]),O=K.length,P=K[0].length,Q=M?K:Array(O),N=0;N<O;N++)for(Q[N]||(Q[N]=Array(P)),R=0;R<P;R++)Q[N][R]=L(K[N][R],N,R);return 1===Q.length?Q[0]:Q},B.cumreduce=function(K,L,M){var N,O,P,Q,R;for(I(K[0])||(K=[K]),O=K.length,P=K[0].length,Q=M?K:Array(O),N=0;N<O;N++)for(Q[N]||(Q[N]=Array(P)),0<P&&(Q[N][0]=K[N][0]),R=1;R<P;R++)Q[N][R]=L(Q[N][R-1],K[N][R]);return 1===Q.length?Q[0]:Q},B.alter=function(K,L){return B.map(K,L,!0)},B.create=function(K,L,M){var O,P,N=Array(K);y(L)&&(M=L,L=K);for(var O=0;O<K;O++)for(N[O]=Array(L),P=0;P<L;P++)N[O][P]=M(O,P);return N},B.zeros=function(K,L){return z(L)||(L=K),B.create(K,L,C)},B.ones=function(K,L){return z(L)||(L=K),B.create(K,L,D)},B.rand=function(K,L){return z(L)||(L=K),B.create(K,L,v.random)},B.identity=function(K,L){return z(L)||(L=K),B.create(K,L,E)},B.symmetric=function(K){var N,O,M=K.length;if(K.length!==K[0].length)return!1;for(N=0;N<M;N++)for(O=0;O<M;O++)if(K[O][N]!==K[N][O])return!1;return!0},B.clear=function(K){return B.alter(K,C)},B.seq=function(K,L,M,N){y(N)||(N=!1);var S,O=[],P=x(K,L),R=K;for(S=0;R<=L;S++,R=(K*P+(L*P-K*P)/((M-1)*P)*P*S)/P)O.push(N?N(R,S):R);return O},B.arange=function(K,L,M){var N=[];if(M=M||1,L===w&&(L=K,K=0),K===L||0===M)return[];if(K<L&&0>M)return[];if(K>L&&0<M)return[];if(0<M)for(i=K;i<L;i+=M)N.push(i);else for(i=K;i>L;i+=M)N.push(i);return N},B.slice=function(){function K(M,N,O,P){var Q,R=[],S=M.length;if(N===w&&O===w&&P===w)return B.copy(M);if(N=N||0,O=O||M.length,N=0<=N?N:S+N,O=0<=O?O:S+O,P=P||1,N===O||0===P)return[];if(N<O&&0>P)return[];if(N>O&&0<P)return[];if(0<P)for(Q=N;Q<O;Q+=P)R.push(M[Q]);else for(Q=N;Q>O;Q+=P)R.push(M[Q]);return R}return function(M,N){if(N=N||{},z(N.row)){if(z(N.col))return M[N.row][N.col];var O=B.rowa(M,N.row),P=N.col||{};return K(O,P.start,P.end,P.step)}if(z(N.col)){var Q=B.cola(M,N.col),R=N.row||{};return K(Q,R.start,R.end,R.step)}var R=N.row||{},P=N.col||{},S=K(M,R.start,R.end,R.step);return S.map(function(T){return K(T,P.start,P.end,P.step)})}}(),B.sliceAssign=function(K,L,M){if(z(L.row)){if(z(L.col))return K[L.row][L.col]=M;L.col=L.col||{},L.col.start=L.col.start||0,L.col.end=L.col.end||K[0].length,L.col.step=L.col.step||1;var N=B.arange(L.col.start,v.min(K.length,L.col.end),L.col.step),O=L.row;return N.forEach(function(R,S){K[O][R]=M[S]}),K}if(z(L.col)){L.row=L.row||{},L.row.start=L.row.start||0,L.row.end=L.row.end||K.length,L.row.step=L.row.step||1;var P=B.arange(L.row.start,v.min(K[0].length,L.row.end),L.row.step),Q=L.col;return P.forEach(function(R,S){K[R][Q]=M[S]}),K}M[0].length===w&&(M=[M]),L.row.start=L.row.start||0,L.row.end=L.row.end||K.length,L.row.step=L.row.step||1,L.col.start=L.col.start||0,L.col.end=L.col.end||K[0].length,L.col.step=L.col.step||1;var P=B.arange(L.row.start,v.min(K.length,L.row.end),L.row.step),N=B.arange(L.col.start,v.min(K[0].length,L.col.end),L.col.step);return P.forEach(function(R,S){N.forEach(function(T,U){K[R][T]=M[S][U]})}),K},B.diagonal=function(K){var L=B.zeros(K.length,K.length);return K.forEach(function(M,N){L[N][N]=M}),L},B.copy=function(K){return K.map(function(L){return z(L)?L:L.map(function(M){return M})})};var J=B.prototype;return J.length=0,J.push=Array.prototype.push,J.sort=Array.prototype.sort,J.splice=Array.prototype.splice,J.slice=Array.prototype.slice,J.toArray=function(){return 1<this.length?G.call(this):G.call(this)[0]},J.map=function(K,L){return B(B.map(this,K,L))},J.cumreduce=function(K,L){return B(B.cumreduce(this,K,L))},J.alter=function(K){return B.alter(this,K),this},function(K){for(var L=0;L<K.length;L++)(function(M){J[M]=function(N){var P,O=this;return N?(setTimeout(function(){N.call(O,J[M].call(O))}),this):(P=B[M](this),I(P)?B(P):P)}})(K[L])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(K){for(var L=0;L<K.length;L++)(function(M){J[M]=function(N,O){var P=this;return O?(setTimeout(function(){O.call(P,J[M].call(P,N))}),this):B(B[M](this,N))}})(K[L])}("row col".split(" ")),function(K){for(var L=0;L<K.length;L++)(function(M){J[M]=new Function("return jStat(jStat."+M+".apply(null, arguments));")})(K[L])}("create zeros ones rand identity".split(" ")),B}(Math),function(v,w){function x(B,C){return B-C}function y(B,C,D){return w.max(C,w.min(B,D))}var z=v.utils.isFunction;v.sum=function(C){for(var B=0,D=C.length;0<=--D;)B+=C[D];return B},v.sumsqrd=function(B){for(var C=0,D=B.length;0<=--D;)C+=B[D]*B[D];return C},v.sumsqerr=function(B){for(var F,C=v.mean(B),D=0,E=B.length;0<=--E;)F=B[E]-C,D+=F*F;return D},v.sumrow=function(B){for(var C=0,D=B.length;0<=--D;)C+=B[D];return C},v.product=function(B){for(var C=1,D=B.length;0<=--D;)C*=B[D];return C},v.min=function(B){for(var C=B[0],D=0;++D<B.length;)B[D]<C&&(C=B[D]);return C},v.max=function(B){for(var C=B[0],D=0;++D<B.length;)B[D]>C&&(C=B[D]);return C},v.unique=function(B){for(var C={},D=[],E=0;E<B.length;E++)C[B[E]]||(C[B[E]]=!0,D.push(B[E]));return D},v.mean=function(B){return v.sum(B)/B.length},v.meansqerr=function(B){return v.sumsqerr(B)/B.length},v.geomean=function(B){return w.pow(v.product(B),1/B.length)},v.median=function(B){var C=B.length,D=B.slice().sort(x);return 1&C?D[0|C/2]:(D[C/2-1]+D[C/2])/2},v.cumsum=function(B){return v.cumreduce(B,function(C,D){return C+D})},v.cumprod=function(B){return v.cumreduce(B,function(C,D){return C*D})},v.diff=function(B){for(var E,C=[],D=B.length,E=1;E<D;E++)C.push(B[E]-B[E-1]);return C},v.rank=function(B){for(var C=B.length,D=B.slice().sort(x),E=Array(C),F=0;F<C;F++){var G=D.indexOf(B[F]),H=D.lastIndexOf(B[F]);if(G===H)var I=G;else var I=(G+H)/2;E[F]=I+1}return E},v.mode=function(B){for(var I,C=B.length,D=B.slice().sort(x),E=1,F=0,G=0,H=[],I=0;I<C;I++)D[I]===D[I+1]?E++:(E>F?(H=[D[I]],F=E,G=0):E==F&&(H.push(D[I]),G++),E=1);return 0==G?H[0]:H},v.range=function(B){return v.max(B)-v.min(B)},v.variance=function(B,C){return v.sumsqerr(B)/(B.length-(C?1:0))},v.deviation=function(B){for(var C=v.mean(B),D=B.length,E=Array(D),F=0;F<D;F++)E[F]=B[F]-C;return E},v.stdev=function(B,C){return w.sqrt(v.variance(B,C))},v.meandev=function(B){for(var E,C=0,D=v.mean(B),E=B.length-1;0<=E;E--)C+=w.abs(B[E]-D);return C/B.length},v.meddev=function(B){for(var E,C=0,D=v.median(B),E=B.length-1;0<=E;E--)C+=w.abs(B[E]-D);return C/B.length},v.coeffvar=function(B){return v.stdev(B)/v.mean(B)},v.quartiles=function(B){var C=B.length,D=B.slice().sort(x);return[D[w.round(C/4)-1],D[w.round(C/2)-1],D[w.round(3*C/4)-1]]},v.quantiles=function(B,C,D,E){var I,J,K,L,M,N,F=B.slice().sort(x),G=[C.length],H=B.length;"undefined"==typeof D&&(D=3/8),"undefined"==typeof E&&(E=3/8);for(var I=0;I<C.length;I++)J=C[I],K=D+J*(1-D-E),L=H*J+K,M=w.floor(y(L,1,H-1)),N=y(L-M,0,1),G[I]=(1-N)*F[M-1]+N*F[M];return G},v.percentile=function(B,C){var D=B.slice().sort(x),E=C*(D.length-1),F=parseInt(E),G=E-F;return F+1<D.length?D[F]*(1-G)+D[F+1]*G:D[F]},v.percentileOfScore=function(B,C,D){var H,I,E=0,F=B.length,G=!1;"strict"===D&&(G=!0);for(var I=0;I<F;I++)H=B[I],(G&&H<C||!G&&H<=C)&&E++;return E/F},v.histogram=function(B,C){for(var H,D=v.min(B),E=C||4,F=(v.max(B)-D)/E,G=B.length,C=[],H=0;H<E;H++)C[H]=0;for(var H=0;H<G;H++)C[w.min(w.floor((B[H]-D)/F),E-1)]+=1;return C},v.covariance=function(B,C){for(var H,D=v.mean(B),E=v.mean(C),F=B.length,G=Array(F),H=0;H<F;H++)G[H]=(B[H]-D)*(C[H]-E);return v.sum(G)/(F-1)},v.corrcoeff=function(B,C){return v.covariance(B,C)/v.stdev(B,1)/v.stdev(C,1)},v.spearmancoeff=function(B,C){B=v.rank(B),C=v.rank(C);var D=v.deviation(B),E=v.deviation(C);return v.sum(D.map(function(F,G){return F*E[G]}))/w.sqrt(v.sum(D.map(function(F){return w.pow(F,2)}))*v.sum(E.map(function(F){return w.pow(F,2)})))},v.stanMoment=function(B,C){for(var D=v.mean(B),E=v.stdev(B),F=B.length,G=0,H=0;H<F;H++)G+=w.pow((B[H]-D)/E,C);return G/B.length},v.skewness=function(B){return v.stanMoment(B,3)},v.kurtosis=function(B){return v.stanMoment(B,4)-3};var A=v.prototype;(function(B){for(var C=0;C<B.length;C++)(function(D){A[D]=function(E,F){var G=[],H=0,I=this;if(z(E)&&(F=E,E=!1),F)return setTimeout(function(){F.call(I,A[D].call(I,E))}),this;if(1<this.length){for(I=!0===E?this:this.transpose();H<I.length;H++)G[H]=v[D](I[H]);return G}return v[D](this[0],E)}})(B[C])})("cumsum cumprod".split(" ")),function(B){for(var C=0;C<B.length;C++)(function(D){A[D]=function(E,F){var G=[],H=0,I=this;if(z(E)&&(F=E,E=!1),F)return setTimeout(function(){F.call(I,A[D].call(I,E))}),this;if(1<this.length){for("sumrow"!==D&&(I=!0===E?this:this.transpose());H<I.length;H++)G[H]=v[D](I[H]);return!0===E?v[D](v.utils.toVector(G)):G}return v[D](this[0],E)}})(B[C])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(B){for(var C=0;C<B.length;C++)(function(D){A[D]=function(){var E=[],F=0,G=this,H=Array.prototype.slice.call(arguments);if(z(H[H.length-1])){var I=H[H.length-1],J=H.slice(0,H.length-1);return setTimeout(function(){I.call(G,A[D].apply(G,J))}),this}var I=void 0,K=function(L){return v[D].apply(G,[L].concat(H))};if(1<this.length){for(G=G.transpose();F<G.length;F++)E[F]=K(G[F]);return E}return K(this[0])}})(B[C])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(v,w){v.gammaln=function(x){var B,C,D,y=0,z=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,0.001208650973866179,-0.000005395239384953],A=1.000000000190015;for(D=(C=B=x)+5.5,D-=(B+.5)*w.log(D);6>y;y++)A+=z[y]/++C;return w.log(2.5066282746310007*A/B)-D},v.gammafn=function(x){var F,G,H,I,y=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],z=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],A=!1,B=0,C=0,D=0,E=x;if(0>=E)if(I=E%1+3.6e-16,I)A=(1&E?-1:1)*w.PI/w.sin(w.PI*I),E=1-E;else return Infinity;H=E,G=1>E?E++:(E-=B=(0|E)-1)-1;for(var F=0;8>F;++F)D=(D+y[F])*G,C=C*G+z[F];if(I=D/C+1,H<E)I/=H;else if(H>E)for(var F=0;F<B;++F)I*=E,E++;return A&&(I=A/I),I},v.gammap=function(x,y){return v.lowRegGamma(x,y)*v.gammafn(x)},v.lowRegGamma=function(x,y){var J,z=v.gammaln(x),A=x,B=1/x,C=B,D=y+1-x,E=9.999999999999999e+29,F=1/D,G=F,H=1,I=-~(8.5*w.log(1<=x?x:1/x)+.4*x+17);if(0>y||0>=x)return NaN;if(y<x+1){for(;H<=I;H++)B+=C*=y/++A;return B*w.exp(-y+x*w.log(y)-z)}for(;H<=I;H++)J=-H*(H-x),D+=2,F=J*F+D,E=D+J/E,F=1/F,G*=F*E;return 1-G*w.exp(-y+x*w.log(y)-z)},v.factorialln=function(x){return 0>x?NaN:v.gammaln(x+1)},v.factorial=function(x){return 0>x?NaN:v.gammafn(x+1)},v.combination=function(x,y){return 170<x||170<y?w.exp(v.combinationln(x,y)):v.factorial(x)/v.factorial(y)/v.factorial(x-y)},v.combinationln=function(x,y){return v.factorialln(x)-v.factorialln(y)-v.factorialln(x-y)},v.permutation=function(x,y){return v.factorial(x)/v.factorial(x-y)},v.betafn=function(x,y){return 0>=x||0>=y?void 0:170<x+y?w.exp(v.betaln(x,y)):v.gammafn(x)*v.gammafn(y)/v.gammafn(x+y)},v.betaln=function(x,y){return v.gammaln(x)+v.gammaln(y)-v.gammaln(x+y)},v.betacf=function(x,y,z){var H,I,J,K,A=1e-30,B=1,C=y+z,D=y+1,F=1,G=1-C*x/D;for(w.abs(G)<A&&(G=A),G=1/G,K=G;100>=B&&(H=2*B,I=B*(z-B)*x/((y-1+H)*(y+H)),G=1+I*G,w.abs(G)<A&&(G=A),F=1+I/F,w.abs(F)<A&&(F=A),G=1/G,K*=G*F,I=-(y+B)*(C+B)*x/((y+H)*(D+H)),G=1+I*G,w.abs(G)<A&&(G=A),F=1+I/F,w.abs(F)<A&&(F=A),G=1/G,J=G*F,K*=J,!(3e-7>w.abs(J-1)));B++);return K},v.gammapinv=function(x,y){var D,E,F,G,H,I,J,z=0,A=y-1,C=v.gammaln(y);if(1<=x)return w.max(100,y+100*w.sqrt(y));if(0>=x)return 0;for(1<y?(I=w.log(A),J=w.exp(A*(I-1)-C),H=.5>x?x:1-x,F=w.sqrt(-2*w.log(H)),D=(2.30753+.27061*F)/(1+F*(.99229+.04481*F))-F,.5>x&&(D=-D),D=w.max(.001,y*w.pow(1-1/(9*y)-D/(3*w.sqrt(y)),3))):(F=1-y*(.253+.12*y),D=x<F?w.pow(x/F,1/y):1-w.log(1-(x-F)/(1-F)));12>z;z++){if(0>=D)return 0;if(E=v.lowRegGamma(y,D)-x,F=1<y?J*w.exp(-(D-A)+A*(w.log(D)-I)):w.exp(-D+A*w.log(D)-C),G=E/F,D-=F=G/(1-.5*w.min(1,G*((y-1)/D-1))),0>=D&&(D=.5*(D+F)),w.abs(F)<1e-8*D)break}return D},v.erf=function(x){var D,E,F,G,y=[-1.3026537197817094,0.6419697923564902,0.019476473204185836,-0.00956151478680863,-0.000946595344482036,0.000366839497852761,0.000042523324806907,-0.000020278578112534,-0.000001624290004647,0.00000130365583558,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],z=y.length-1,A=!1,B=0,C=0;for(0>x&&(x=-x,A=!0),D=2/(2+x),E=4*D-2;0<z;z--)F=B,B=E*B-C+y[z],C=F;return G=D*w.exp(-x*x+.5*(y[0]+E*B)-C),A?G-1:1-G},v.erfc=function(x){return 1-v.erf(x)},v.erfcinv=function(x){var z,A,B,C,y=0;if(2<=x)return-100;if(0>=x)return 100;for(C=1>x?x:2-x,B=w.sqrt(-2*w.log(C/2)),z=-0.70711*((2.30753+.27061*B)/(1+B*(.99229+.04481*B))-B);2>y;y++)A=v.erfc(z)-C,z+=A/(1.1283791670955126*w.exp(-z*z)-z*A);return 1>x?z:-z},v.ibetainv=function(x,y,z){var E,F,G,H,I,J,K,L,M,N,O,B=y-1,C=z-1,D=0;if(0>=x)return 0;if(1<=x)return 1;for(1<=y&&1<=z?(G=.5>x?x:1-x,H=w.sqrt(-2*w.log(G)),K=(2.30753+.27061*H)/(1+H*(.99229+.04481*H))-H,.5>x&&(K=-K),L=(K*K-3)/6,M=2/(1/(2*y-1)+1/(2*z-1)),N=K*w.sqrt(L+M)/M-(1/(2*z-1)-1/(2*y-1))*(L+5/6-2/(3*M)),K=y/(y+z*w.exp(2*N))):(E=w.log(y/(y+z)),F=w.log(z/(y+z)),H=w.exp(y*E)/y,I=w.exp(z*F)/z,N=H+I,K=x<H/N?w.pow(y*N*x,1/y):1-w.pow(z*N*(1-x),1/z)),O=-v.gammaln(y)-v.gammaln(z)+v.gammaln(y+z);10>D;D++){if(0===K||1===K)return K;if(J=v.ibeta(K,y,z)-x,H=w.exp(B*w.log(K)+C*w.log(1-K)+O),I=J/H,K-=H=I/(1-.5*w.min(1,I*(B/K-C/(1-K)))),0>=K&&(K=.5*(K+H)),1<=K&&(K=.5*(K+H+1)),w.abs(H)<1e-8*K&&0<D)break}return K},v.ibeta=function(x,y,z){var A=0===x||1===x?0:w.exp(v.gammaln(y+z)-v.gammaln(y)-v.gammaln(z)+y*w.log(x)+z*w.log(1-x));return 0>x||1<x?!1:x<(y+1)/(y+z+2)?A*v.betacf(x,y,z)/y:1-A*v.betacf(1-x,z,y)/z},v.randn=function(x,y){var z,A,B,C,D;if(y||(y=x),x)return v.create(x,y,function(){return v.randn()});do z=w.random(),A=1.7156*(w.random()-.5),B=z-.449871,C=w.abs(A)+.386595,D=B*B+C*(.196*C-.25472*B);while(.27597<D&&(.27846<D||A*A>-4*w.log(z)*z*z));return A/z},v.randg=function(x,y,z){var B,C,D,E,F,G,A=x;if(z||(z=y),x||(x=1),y)return G=v.zeros(y,z),G.alter(function(){return v.randg(x)}),G;1>x&&(x+=1),B=x-1/3,C=1/w.sqrt(9*B);do{do F=v.randn(),E=1+C*F;while(0>=E);E=E*E*E,D=w.random()}while(D>1-.331*w.pow(F,4)&&w.log(D)>.5*F*F+B*(1-E+w.log(E)));if(x==A)return B*E;do D=w.random();while(0===D);return w.pow(D,1/A)*B*E},function(x){for(var y=0;y<x.length;y++)(function(z){v.fn[z]=function(){return v(v.map(this,function(A){return v[z](A)}))}})(x[y])}("gammaln gammafn factorial factorialln".split(" ")),function(x){for(var y=0;y<x.length;y++)(function(z){v.fn[z]=function(){return v(v[z].apply(null,arguments))}})(x[y])}("randn".split(" "))}(this.jStat,Math),function(v,w){function x(y){return y/w.abs(y)}(function(y){for(var z=0;z<y.length;z++)(function(A){v[A]=function(B,C,D){return this instanceof arguments.callee?(this._a=B,this._b=C,this._c=D,this):new arguments.callee(B,C,D)},v.fn[A]=function(B,C,D){var E=v[A](B,C,D);return E.data=this,E},v[A].prototype.sample=function(B){var C=this._a,D=this._b,E=this._c;return B?v.alter(B,function(){return v[A].sample(C,D,E)}):v[A].sample(C,D,E)},function(B){for(var C=0;C<B.length;C++)(function(D){v[A].prototype[D]=function(E){var F=this._a,G=this._b,H=this._c;return!E&&0!==E&&(E=this.data),"number"==typeof E?v[A][D](E,F,G,H):v.fn.map.call(E,function(I){return v[A][D](I,F,G,H)})}})(B[C])}("pdf cdf inv".split(" ")),function(B){for(var C=0;C<B.length;C++)(function(D){v[A].prototype[D]=function(){return v[A][D](this._a,this._b,this._c)}})(B[C])}("mean median mode variance".split(" "))})(y[z])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular".split(" ")),v.extend(v.beta,{pdf:function(y,z,A){return 1<y||0>y?0:1==z&&1==A?1:512>z&&512>A?w.pow(y,z-1)*w.pow(1-y,A-1)/v.betafn(z,A):w.exp((z-1)*w.log(y)+(A-1)*w.log(1-y)-v.betaln(z,A))},cdf:function(y,z,A){return 1<y||0>y?1*(1<y):v.ibeta(y,z,A)},inv:function(y,z,A){return v.ibetainv(y,z,A)},mean:function(y,z){return y/(y+z)},median:function(y,z){return v.ibetainv(.5,y,z)},mode:function(y,z){return(y-1)/(y+z-2)},sample:function(y,z){var A=v.randg(y);return A/(A+v.randg(z))},variance:function(y,z){return y*z/(w.pow(y+z,2)*(y+z+1))}}),v.extend(v.centralF,{pdf:function(y,z,A){var B,C,D;return 0>y?0:2>=z?0===y&&2>z?Infinity:0===y&&2===z?1:w.sqrt(w.pow(z*y,z)*w.pow(A,A)/w.pow(z*y+A,z+A))/(y*v.betafn(z/2,A/2)):(B=z*y/(A+y*z),C=A/(A+y*z),D=z*C/2,D*v.binomial.pdf((z-2)/2,(z+A-2)/2,B))},cdf:function(y,z,A){return 0>y?0:v.ibeta(z*y/(z*y+A),z/2,A/2)},inv:function(y,z,A){return A/(z*(1/v.ibetainv(y,z/2,A/2)-1))},mean:function(y,z){return 2<z?z/(z-2):void 0},mode:function(y,z){return 2<y?z*(y-2)/(y*(z+2)):void 0},sample:function(y,z){var A=2*v.randg(y/2),B=2*v.randg(z/2);return A/y/(B/z)},variance:function(y,z){return 4>=z?void 0:2*z*z*(y+z-2)/(y*(z-2)*(z-2)*(z-4))}}),v.extend(v.cauchy,{pdf:function(y,z,A){return 0>A?0:A/(w.pow(y-z,2)+w.pow(A,2))/w.PI},cdf:function(y,z,A){return w.atan((y-z)/A)/w.PI+.5},inv:function(y,z,A){return z+A*w.tan(w.PI*(y-.5))},median:function(y){return y},mode:function(y){return y},sample:function(y,z){return v.randn()*w.sqrt(1/(2*v.randg(.5)))*z+y}}),v.extend(v.chisquare,{pdf:function(y,z){return 0>y?0:0===y&&2===z?.5:w.exp((z/2-1)*w.log(y)-y/2-z/2*w.log(2)-v.gammaln(z/2))},cdf:function(y,z){return 0>y?0:v.lowRegGamma(z/2,y/2)},inv:function(y,z){return 2*v.gammapinv(y,.5*z)},mean:function(y){return y},median:function(y){return y*w.pow(1-2/(9*y),3)},mode:function(y){return 0<y-2?y-2:0},sample:function(y){return 2*v.randg(y/2)},variance:function(y){return 2*y}}),v.extend(v.exponential,{pdf:function(y,z){return 0>y?0:z*w.exp(-z*y)},cdf:function(y,z){return 0>y?0:1-w.exp(-z*y)},inv:function(y,z){return-w.log(1-y)/z},mean:function(y){return 1/y},median:function(y){return 1/y*w.log(2)},mode:function(){return 0},sample:function(y){return-1/y*w.log(w.random())},variance:function(y){return w.pow(y,-2)}}),v.extend(v.gamma,{pdf:function(y,z,A){return 0>y?0:0===y&&1===z?1/A:w.exp((z-1)*w.log(y)-y/A-v.gammaln(z)-z*w.log(A))},cdf:function(y,z,A){return 0>y?0:v.lowRegGamma(z,y/A)},inv:function(y,z,A){return v.gammapinv(y,z)*A},mean:function(y,z){return y*z},mode:function(y,z){return 1<y?(y-1)*z:void 0},sample:function(y,z){return v.randg(y)*z},variance:function(y,z){return y*z*z}}),v.extend(v.invgamma,{pdf:function(y,z,A){return 0>=y?0:w.exp(-(z+1)*w.log(y)-A/y-v.gammaln(z)+z*w.log(A))},cdf:function(y,z,A){return 0>=y?0:1-v.lowRegGamma(z,A/y)},inv:function(y,z,A){return A/v.gammapinv(1-y,z)},mean:function(y,z){return 1<y?z/(y-1):void 0},mode:function(y,z){return z/(y+1)},sample:function(y,z){return z/v.randg(y)},variance:function(y,z){return 2>=y?void 0:z*z/((y-1)*(y-1)*(y-2))}}),v.extend(v.kumaraswamy,{pdf:function(y,z,A){return 0===y&&1===z?A:1===y&&1===A?z:w.exp(w.log(z)+w.log(A)+(z-1)*w.log(y)+(A-1)*w.log(1-w.pow(y,z)))},cdf:function(y,z,A){return 0>y?0:1<y?1:1-w.pow(1-w.pow(y,z),A)},inv:function(y,z,A){return w.pow(1-w.pow(1-y,1/A),1/z)},mean:function(y,z){return z*v.gammafn(1+1/y)*v.gammafn(z)/v.gammafn(1+1/y+z)},median:function(y,z){return w.pow(1-w.pow(2,-1/z),1/y)},mode:function(y,z){return 1<=y&&1<=z&&1!==y&&1!==z?w.pow((y-1)/(y*z-1),1/y):void 0},variance:function(){throw new Error("variance not yet implemented")}}),v.extend(v.lognormal,{pdf:function(y,z,A){return 0>=y?0:w.exp(-w.log(y)-.5*w.log(2*w.PI)-w.log(A)-w.pow(w.log(y)-z,2)/(2*A*A))},cdf:function(y,z,A){return 0>y?0:.5+.5*v.erf((w.log(y)-z)/w.sqrt(2*A*A))},inv:function(y,z,A){return w.exp(-1.4142135623730951*A*v.erfcinv(2*y)+z)},mean:function(y,z){return w.exp(y+z*z/2)},median:function(y){return w.exp(y)},mode:function(y,z){return w.exp(y-z*z)},sample:function(y,z){return w.exp(v.randn()*z+y)},variance:function(y,z){return(w.exp(z*z)-1)*w.exp(2*y+z*z)}}),v.extend(v.noncentralt,{pdf:function(y,z,A){var B=1e-14;return w.abs(A)<B?v.studentt.pdf(y,z):w.abs(y)<B?w.exp(v.gammaln((z+1)/2)-A*A/2-.5*w.log(w.PI*z)-v.gammaln(z/2)):z/y*(v.noncentralt.cdf(y*w.sqrt(1+2/z),z+2,A)-v.noncentralt.cdf(y,z,A))},cdf:function(y,z,A){var B=1e-14;if(w.abs(A)<B)return v.studentt.cdf(y,z);var D=!1;0>y&&(D=!0,A=-A);for(var E=v.normal.cdf(-A,0,1),F=B+1,G=F,H=y*y/(y*y+z),I=0,J=w.exp(-A*A/2),K=w.exp(-A*A/2-.5*w.log(2)-v.gammaln(1.5))*A;I<200||G>B||F>B;)G=F,0<I&&(J*=A*A/(2*I),K*=A*A/(2*(I+.5))),F=J*v.beta.cdf(H,I+.5,z/2)+K*v.beta.cdf(H,I+1,z/2),E+=.5*F,I++;return D?1-E:E}}),v.extend(v.normal,{pdf:function(y,z,A){return w.exp(-0.5*w.log(2*w.PI)-w.log(A)-w.pow(y-z,2)/(2*A*A))},cdf:function(y,z,A){return .5*(1+v.erf((y-z)/w.sqrt(2*A*A)))},inv:function(y,z,A){return-1.4142135623730951*A*v.erfcinv(2*y)+z},mean:function(y){return y},median:function(y){return y},mode:function(y){return y},sample:function(y,z){return v.randn()*z+y},variance:function(y,z){return z*z}}),v.extend(v.pareto,{pdf:function(y,z,A){return y<z?0:A*w.pow(z,A)/w.pow(y,A+1)},cdf:function(y,z,A){return y<z?0:1-w.pow(z/y,A)},inv:function(y,z,A){return z/w.pow(1-y,1/A)},mean:function(y,z){return 1>=z?void 0:z*w.pow(y,z)/(z-1)},median:function(y,z){return y*z*w.SQRT2},mode:function(y){return y},variance:function(y,z){return 2>=z?void 0:y*y*z/(w.pow(z-1,2)*(z-2))}}),v.extend(v.studentt,{pdf:function(y,z){return z=1e100<z?1e100:z,1/(w.sqrt(z)*v.betafn(.5,z/2))*w.pow(1+y*y/z,-((z+1)/2))},cdf:function(y,z){var A=z/2;return v.ibeta((y+w.sqrt(y*y+z))/(2*w.sqrt(y*y+z)),A,A)},inv:function(y,z){var A=v.ibetainv(2*w.min(y,1-y),.5*z,.5);return A=w.sqrt(z*(1-A)/A),.5<y?A:-A},mean:function(y){return 1<y?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(y){return v.randn()*w.sqrt(y/(2*v.randg(y/2)))},variance:function(y){return 2<y?y/(y-2):1<y?Infinity:void 0}}),v.extend(v.weibull,{pdf:function(y,z,A){return 0>y||0>z||0>A?0:A/z*w.pow(y/z,A-1)*w.exp(-w.pow(y/z,A))},cdf:function(y,z,A){return 0>y?0:1-w.exp(-w.pow(y/z,A))},inv:function(y,z,A){return z*w.pow(-w.log(1-y),1/A)},mean:function(y,z){return y*v.gammafn(1+1/z)},median:function(y,z){return y*w.pow(w.log(2),1/z)},mode:function(y,z){return 1>=z?0:y*w.pow((z-1)/z,1/z)},sample:function(y,z){return y*w.pow(-w.log(w.random()),1/z)},variance:function(y,z){return y*y*v.gammafn(1+2/z)-w.pow(v.weibull.mean(y,z),2)}}),v.extend(v.uniform,{pdf:function(y,z,A){return y<z||y>A?0:1/(A-z)},cdf:function(y,z,A){return y<z?0:y<A?(y-z)/(A-z):1},inv:function(y,z,A){return z+y*(A-z)},mean:function(y,z){return .5*(y+z)},median:function(y,z){return v.mean(y,z)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(y,z){return y/2+z/2+(z/2-y/2)*(2*w.random()-1)},variance:function(y,z){return w.pow(z-y,2)/12}}),v.extend(v.binomial,{pdf:function(y,z,A){return 0===A||1===A?z*A===y?1:0:v.combination(z,y)*w.pow(A,y)*w.pow(1-A,z-y)},cdf:function(y,z,A){var B=[],C=0;if(0>y)return 0;if(y<z){for(;C<=y;C++)B[C]=v.binomial.pdf(C,z,A);return v.sum(B)}return 1}}),v.extend(v.negbin,{pdf:function(y,z,A){return!(y!==y>>>0)&&(0>y?0:v.combination(y+z-1,z-1)*w.pow(1-A,y)*w.pow(A,z))},cdf:function(y,z,A){var B=0,C=0;if(0>y)return 0;for(;C<=y;C++)B+=v.negbin.pdf(C,z,A);return B}}),v.extend(v.hypgeom,{pdf:function(y,z,A,B){if(0|y!==y)return!1;if(0>y||y<A-(z-B))return 0;if(y>B||y>A)return 0;if(2*A>z)return 2*B>z?v.hypgeom.pdf(z-A-B+y,z,z-A,z-B):v.hypgeom.pdf(B-y,z,z-A,B);if(2*B>z)return v.hypgeom.pdf(A-y,z,A,z-B);if(A<B)return v.hypgeom.pdf(y,z,B,A);for(var C=1,D=0,E=0;E<y;E++){for(;1<C&&D<B;)C*=1-A/(z-D),D++;C*=(B-E)*(A-E)/((E+1)*(z-A-B+E+1))}for(;D<B;D++)C*=1-A/(z-D);return w.min(1,w.max(0,C))},cdf:function(y,z,A,B){if(0>y||y<A-(z-B))return 0;if(y>=B||y>=A)return 1;if(2*A>z)return 2*B>z?v.hypgeom.cdf(z-A-B+y,z,z-A,z-B):1-v.hypgeom.cdf(B-y-1,z,z-A,B);if(2*B>z)return 1-v.hypgeom.cdf(A-y-1,z,A,z-B);if(A<B)return v.hypgeom.cdf(y,z,B,A);for(var C=1,D=1,E=0,F=0;F<y;F++){for(;1<C&&E<B;){var G=1-A/(z-E);D*=G,C*=G,E++}D*=(B-F)*(A-F)/((F+1)*(z-A-B+F+1)),C+=D}for(;E<B;E++)C*=1-A/(z-E);return w.min(1,w.max(0,C))}}),v.extend(v.poisson,{pdf:function(y,z){return 0>z||0!=y%1||0>y?0:w.pow(z,y)*w.exp(-z)/v.factorial(y)},cdf:function(y,z){var A=[],B=0;if(0>y)return 0;for(;B<=y;B++)A.push(v.poisson.pdf(B,z));return v.sum(A)},mean:function(y){return y},variance:function(y){return y},sample:function(y){var z=1,A=0,B=w.exp(-y);do A++,z*=w.random();while(z>B);return A-1}}),v.extend(v.triangular,{pdf:function(y,z,A,B){return A<=z||B<z||B>A?NaN:y<z||y>A?0:y<B?2*(y-z)/((A-z)*(B-z)):y===B?2/(A-z):2*(A-y)/((A-z)*(A-B))},cdf:function(y,z,A,B){return A<=z||B<z||B>A?NaN:y<=z?0:y>=A?1:y<=B?w.pow(y-z,2)/((A-z)*(B-z)):1-w.pow(A-y,2)/((A-z)*(A-B))},inv:function(y,z,A,B){return A<=z||B<z||B>A?NaN:y<=(B-z)/(A-z)?z+(A-z)*w.sqrt(y*((B-z)/(A-z))):z+(A-z)*(1-w.sqrt((1-y)*(1-(B-z)/(A-z))))},mean:function(y,z,A){return(y+z+A)/3},median:function(y,z,A){return A<=(y+z)/2?z-w.sqrt((z-y)*(z-A))/w.sqrt(2):A>(y+z)/2?y+w.sqrt((z-y)*(A-y))/w.sqrt(2):void 0},mode:function(y,z,A){return A},sample:function(y,z,A){var B=w.random();return B<(A-y)/(z-y)?y+w.sqrt(B*(z-y)*(A-y)):z-w.sqrt((1-B)*(z-y)*(z-A))},variance:function(y,z,A){return(y*y+z*z+A*A-y*z-y*A-z*A)/18}}),v.extend(v.laplace,{pdf:function(y,z,A){return 0>=A?0:w.exp(-w.abs(y-z)/A)/(2*A)},cdf:function(y,z,A){return 0>=A?0:y<z?.5*w.exp((y-z)/A):1-.5*w.exp(-(y-z)/A)},mean:function(y){return y},median:function(y){return y},mode:function(y){return y},variance:function(y,z){return 2*z*z},sample:function(y,z){var A=w.random()-.5;return y-z*x(A)*w.log(1-2*w.abs(A))}})}(this.jStat,Math),function(v,w){function x(A){return z(A)||A instanceof v}var y=Array.prototype.push,z=v.utils.isArray;v.extend({add:function(A,B){return x(B)?(x(B[0])||(B=[B]),v.map(A,function(C,D,E){return C+B[D][E]})):v.map(A,function(C){return C+B})},subtract:function(A,B){return x(B)?(x(B[0])||(B=[B]),v.map(A,function(C,D,E){return C-B[D][E]||0})):v.map(A,function(C){return C-B})},divide:function(A,B){return x(B)?(x(B[0])||(B=[B]),v.multiply(A,v.inv(B))):v.map(A,function(C){return C/B})},multiply:function(A,B){var C,D,E,F,G,H,I,J;if(void 0===A.length&&void 0===B.length)return A*B;if(G=A.length,H=A[0].length,I=v.zeros(G,E=x(B)?B[0].length:H),J=0,x(B)){for(;J<E;J++)for(C=0;C<G;C++){for(F=0,D=0;D<H;D++)F+=A[C][D]*B[D][J];I[C][J]=F}return 1===G&&1===J?I[0][0]:I}return v.map(A,function(K){return K*B})},outer:function(A,B){return v.multiply(A.map(function(C){return[C]}),[B])},dot:function(A,B){x(A[0])||(A=[A]),x(B[0])||(B=[B]);for(var I,J,C=1===A[0].length&&1!==A.length?v.transpose(A):A,D=1===B[0].length&&1!==B.length?v.transpose(B):B,E=[],F=0,G=C.length,H=C[0].length;F<G;F++){for(E[F]=[],I=0,J=0;J<H;J++)I+=C[F][J]*D[F][J];E[F]=I}return 1===E.length?E[0]:E},pow:function(A,B){return v.map(A,function(C){return w.pow(C,B)})},exp:function(A){return v.map(A,function(B){return w.exp(B)})},log:function(A){return v.map(A,function(B){return w.log(B)})},abs:function(A){return v.map(A,function(B){return w.abs(B)})},norm:function(A,B){var C=0,D=0;for(isNaN(B)&&(B=2),x(A[0])&&(A=A[0]);D<A.length;D++)C+=w.pow(w.abs(A[D]),B);return w.pow(C,1/B)},angle:function(A,B){return w.acos(v.dot(A,B)/(v.norm(A)*v.norm(B)))},aug:function(A,B){for(var C=[],D=0;D<A.length;D++)C.push(A[D].slice());for(var D=0;D<C.length;D++)y.apply(C[D],B[D]);return C},inv:function(A){for(var H,B=A.length,C=A[0].length,D=v.identity(B,C),E=v.gauss_jordan(A,D),F=[],G=0;G<B;G++)for(F[G]=[],H=C;H<E[0].length;H++)F[G][H-C]=E[G][H];return F},det:function(A){var K,B=A.length,C=2*B,D=Array(C),E=B-1,F=C-1,G=E-B+1,H=F,I=0,J=0;if(2===B)return A[0][0]*A[1][1]-A[0][1]*A[1][0];for(;I<C;I++)D[I]=1;for(var I=0;I<B;I++){for(K=0;K<B;K++)D[0>G?G+B:G]*=A[I][K],D[H<B?H+B:H]*=A[I][K],G++,H--;G=--E-B+1,H=--F}for(var I=0;I<B;I++)J+=D[I];for(;I<C;I++)J-=D[I];return J},gauss_elimination:function(A,B){var J,K,L,M,C=0,D=0,E=A.length,F=A[0].length,G=1,H=0,I=[];A=v.aug(A,B),J=A[0].length;for(var C=0;C<E;C++){for(K=A[C][C],D=C,M=C+1;M<F;M++)K<w.abs(A[M][C])&&(K=A[M][C],D=M);if(D!=C)for(M=0;M<J;M++)L=A[C][M],A[C][M]=A[D][M],A[D][M]=L;for(D=C+1;D<E;D++)for(G=A[D][C]/A[C][C],M=C;M<J;M++)A[D][M]-=G*A[C][M]}for(var C=E-1;0<=C;C--){for(H=0,D=C+1;D<=E-1;D++)H+=I[D]*A[C][D];I[C]=(A[C][J-1]-H)/A[C][C]}return I},gauss_jordan:function(A,B){for(var G,C=v.aug(A,B),D=C.length,E=C[0].length,F=0;F<D;F++){G=F;for(var H=F+1;H<D;H++)w.abs(C[H][F])>w.abs(C[G][F])&&(G=H);var I=C[F];C[F]=C[G],C[G]=I;for(var H=F+1;H<D;H++){c=C[H][F]/C[F][F];for(var J=F;J<E;J++)C[H][J]-=C[F][J]*c}}for(var F=D-1;0<=F;F--){c=C[F][F];for(var H=0;H<F;H++)for(var J=E-1;J>F-1;J--)C[H][J]-=C[F][J]*C[H][F]/c;C[F][F]/=c;for(var J=D;J<E;J++)C[F][J]/=c}return C},triaUpSolve:function(A,B){var E,C=A[0].length,D=v.zeros(1,C)[0],F=!1;return B[0].length!=void 0&&(B=B.map(function(G){return G[0]}),F=!0),v.arange(C-1,-1,-1).forEach(function(G){E=v.arange(G+1,C).map(function(H){return D[H]*A[G][H]}),D[G]=(B[G]-v.sum(E))/A[G][G]}),F?D.map(function(G){return[G]}):D},triaLowSolve:function(A,B){var E,C=A[0].length,D=v.zeros(1,C)[0],F=!1;return B[0].length!=void 0&&(B=B.map(function(G){return G[0]}),F=!0),v.arange(C).forEach(function(G){E=v.arange(G).map(function(H){return A[G][H]*D[H]}),D[G]=(B[G]-v.sum(E))/A[G][G]}),F?D.map(function(G){return[G]}):D},lu:function(A){var E,B=A.length,C=v.identity(B),D=v.zeros(A.length,A[0].length);return v.arange(B).forEach(function(F){D[0][F]=A[0][F]}),v.arange(1,B).forEach(function(F){v.arange(F).forEach(function(G){E=v.arange(G).map(function(H){return C[F][H]*D[H][G]}),C[F][G]=(A[F][G]-v.sum(E))/D[G][G]}),v.arange(F,B).forEach(function(G){E=v.arange(F).map(function(H){return C[F][H]*D[H][G]}),D[F][G]=A[i][G]-v.sum(E)})}),[C,D]},cholesky:function(A){var D,B=A.length,C=v.zeros(A.length,A[0].length);return v.arange(B).forEach(function(E){D=v.arange(E).map(function(F){return w.pow(C[E][F],2)}),C[E][E]=w.sqrt(A[E][E]-v.sum(D)),v.arange(E+1,B).forEach(function(F){D=v.arange(E).map(function(G){return C[E][G]*C[F][G]}),C[F][E]=(A[E][F]-v.sum(D))/C[E][E]})}),C},gauss_jacobi:function(A,B,C,D){for(var K,L,M,N,E=0,F=0,G=A.length,H=[],I=[],J=[];E<G;E++)for(H[E]=[],I[E]=[],J[E]=[],F=0;F<G;F++)E>F?(H[E][F]=A[E][F],I[E][F]=J[E][F]=0):E<F?(I[E][F]=A[E][F],H[E][F]=J[E][F]=0):(J[E][F]=A[E][F],H[E][F]=I[E][F]=0);for(M=v.multiply(v.multiply(v.inv(J),v.add(H,I)),-1),L=v.multiply(v.inv(J),B),K=C,N=v.add(v.multiply(M,C),L),E=2;w.abs(v.norm(v.subtract(N,K)))>D;)K=N,N=v.add(v.multiply(M,K),L),E++;return N},gauss_seidel:function(A,B,C,D){for(var J,K,L,M,N,E=0,F=A.length,G=[],H=[],I=[];E<F;E++)for(G[E]=[],H[E]=[],I[E]=[],J=0;J<F;J++)E>J?(G[E][J]=A[E][J],H[E][J]=I[E][J]=0):E<J?(H[E][J]=A[E][J],G[E][J]=I[E][J]=0):(I[E][J]=A[E][J],G[E][J]=H[E][J]=0);for(M=v.multiply(v.multiply(v.inv(v.add(I,G)),H),-1),L=v.multiply(v.inv(v.add(I,G)),B),K=C,N=v.add(v.multiply(M,C),L),E=2;w.abs(v.norm(v.subtract(N,K)))>D;)K=N,N=v.add(v.multiply(M,K),L),E+=1;return N},SOR:function(A,B,C,D,E){for(var K,L,M,N,O,F=0,G=A.length,H=[],I=[],J=[];F<G;F++)for(H[F]=[],I[F]=[],J[F]=[],K=0;K<G;K++)F>K?(H[F][K]=A[F][K],I[F][K]=J[F][K]=0):F<K?(I[F][K]=A[F][K],H[F][K]=J[F][K]=0):(J[F][K]=A[F][K],H[F][K]=I[F][K]=0);for(N=v.multiply(v.inv(v.add(J,v.multiply(H,E))),v.subtract(v.multiply(J,1-E),v.multiply(I,E))),M=v.multiply(v.multiply(v.inv(v.add(J,v.multiply(H,E))),B),E),L=C,O=v.add(v.multiply(N,C),M),F=2;w.abs(v.norm(v.subtract(O,L)))>D;)L=O,O=v.add(v.multiply(N,L),M),F++;return O},householder:function(A){for(var G,H,I,J,K,B=A.length,C=A[0].length,D=0,E=[],F=[];D<B-1;D++){for(G=0,J=D+1;J<C;J++)G+=A[J][D]*A[J][D];for(K=0<A[D+1][D]?-1:1,G=K*w.sqrt(G),H=w.sqrt((G*G-A[D+1][D]*G)/2),E=v.zeros(B,1),E[D+1][0]=(A[D+1][D]-G)/(2*H),I=D+2;I<B;I++)E[I][0]=A[I][D]/(2*H);F=v.subtract(v.identity(B,C),v.multiply(v.multiply(E,v.transpose(E)),2)),A=v.multiply(F,v.multiply(A,F))}return A},QR:function(){function A(C){var D=C.length,E=v.norm(C,2),F=v.zeros(1,D)[0];F[0]=1;var G=v.add(v.multiply(v.multiply(F,E),-1),C),H=v.norm(G,2),I=v.divide(G,H),J=v.subtract(v.identity(D),v.multiply(v.outer(I,I),2));return J}return function(C){var D=C[0].length,E=[];v.arange(D).forEach(function(H){var I=v.slice(C,{row:{start:H},col:H}),J=A(I),K=v.identity(C.length);K=v.sliceAssign(K,{row:{start:H},col:{start:H}},J),C=v.multiply(K,C),E.push(K)});var F=E.reduce(function(H,I){return v.multiply(H,I)}),G=C;return[F,G]}}(),lstsq:function(){function C(E){E=v.copy(E);var F=E.length,G=v.identity(F);return v.arange(F-1,-1,-1).forEach(function(H){v.sliceAssign(G,{row:H},v.divide(v.slice(G,{row:H}),E[H][H])),v.sliceAssign(E,{row:H},v.divide(v.slice(E,{row:H}),E[H][H])),v.arange(H).forEach(function(I){var J=v.multiply(E[I][H],-1),K=v.slice(E,{row:I}),L=v.multiply(v.slice(E,{row:H}),J);v.sliceAssign(E,{row:I},v.add(K,L));var M=v.slice(G,{row:I}),N=v.multiply(v.slice(G,{row:H}),J);v.sliceAssign(G,{row:I},v.add(M,N))})}),G}return function(E,F){var G=!1;F[0].length===void 0&&(F=F.map(function(P){return[P]}),G=!0);var H=v.QR(E),I=H[0],J=H[1],K=E[0].length,L=v.slice(I,{col:{end:K}}),M=v.slice(J,{row:{end:K}}),N=C(M),O=v.multiply(v.multiply(N,v.transpose(L)),F);return G?O.map(function(P){return P[0]}):O}}(),jacobi:function(A){for(var G,H,I,J,K,L,M,N,B=1,C=0,D=A.length,E=v.identity(D,D),F=[];1==B;){C++,L=A[0][1],J=0,K=1;for(var H=0;H<D;H++)for(I=0;I<D;I++)H!=I&&L<w.abs(A[H][I])&&(L=w.abs(A[H][I]),J=H,K=I);M=A[J][J]===A[K][K]?0<A[J][K]?w.PI/4:-w.PI/4:w.atan(2*A[J][K]/(A[J][J]-A[K][K]))/2,N=v.identity(D,D),N[J][J]=w.cos(M),N[J][K]=-w.sin(M),N[K][J]=w.sin(M),N[K][K]=w.cos(M),E=v.multiply(E,N),G=v.multiply(v.multiply(v.inv(N),A),N),A=G,B=0;for(var H=1;H<D;H++)for(I=1;I<D;I++)H!=I&&.001<w.abs(A[H][I])&&(B=1)}for(var H=0;H<D;H++)F.push(A[H][H]);return[E,F]},rungekutta:function(A,B,C,D,E,F){var G,H,I,J,K;if(2===F)for(;D<=C;)G=B*A(D,E),H=B*A(D+B,E+G),I=E+(G+H)/2,E=I,D+=B;if(4===F)for(;D<=C;)G=B*A(D,E),H=B*A(D+B/2,E+G/2),J=B*A(D+B/2,E+H/2),K=B*A(D+B,E+J),I=E+(G+2*H+2*J+K)/6,E=I,D+=B;return E},romberg:function(A,B,C,D){for(var J,K,L,M,N,E=0,F=(C-B)/2,G=[],H=[],I=[];E<D/2;){for(N=A(B),L=B,M=0;L<=C;L+=F,M++)G[M]=L;for(J=G.length,L=1;L<J-1;L++)N+=(0==L%2?2:4)*A(G[L]);N=F/3*(N+A(C)),I[E]=N,F/=2,E++}for(K=I.length,J=1;1!==K;){for(L=0;L<K-1;L++)H[L]=(w.pow(4,J)*I[L+1]-I[L])/(w.pow(4,J)-1);K=H.length,I=H,H=[],J++}return I},richardson:function(A,B,C,D){function E(P,Q){for(var T,R=0,S=P.length;R<S;R++)P[R]===Q&&(T=R);return T}for(var K,L,M,N,O,F=A.length,G=w.abs(C-A[E(A,C)+1]),H=0,I=[],J=[];D>=G;)K=E(A,C+D),L=E(A,C),I[H]=(B[K]-2*B[L]+B[2*L-K])/(D*D),D/=2,H++;for(N=I.length,M=1;1!=N;){for(O=0;O<N-1;O++)J[O]=(w.pow(4,M)*I[O+1]-I[O])/(w.pow(4,M)-1);N=J.length,I=J,J=[],M++}return I},simpson:function(A,B,C,D){for(var K,E=(C-B)/D,F=A(B),G=[],H=B,I=0,J=1;H<=C;H+=E,I++)G[I]=H;for(K=G.length;J<K-1;J++)F+=(0==J%2?2:4)*A(G[J]);return E/3*(F+A(C))},hermite:function(A,B,C,D){for(var L,E=A.length,F=0,G=0,H=[],I=[],J=[],K=[];G<E;G++){for(H[G]=1,L=0;L<E;L++)G!=L&&(H[G]*=(D-A[L])/(A[G]-A[L]));for(I[G]=0,L=0;L<E;L++)G!=L&&(I[G]+=1/(A[G]-A[L]));J[G]=(1-2*(D-A[G])*I[G])*H[G]*H[G],K[G]=(D-A[G])*H[G]*H[G],F+=J[G]*B[G]+K[G]*C[G]}return F},lagrange:function(A,B,C){for(var F,G,D=0,E=0,H=A.length;E<H;E++){for(G=B[E],F=0;F<H;F++)E!=F&&(G*=(C-A[F])/(A[E]-A[F]));D+=G}return D},cubic_spline:function(A,B,C){for(var F,D=A.length,E=0,G=[],H=[],I=[],J=[],K=[],L=[],M=[];E<D-1;E++)K[E]=A[E+1]-A[E];I[0]=0;for(var E=1;E<D-1;E++)I[E]=3/K[E]*(B[E+1]-B[E])-3/K[E-1]*(B[E]-B[E-1]);for(var E=1;E<D-1;E++)G[E]=[],H[E]=[],G[E][E-1]=K[E-1],G[E][E]=2*(K[E-1]+K[E]),G[E][E+1]=K[E],H[E][0]=I[E];for(J=v.multiply(v.inv(G),H),F=0;F<D-1;F++)L[F]=(B[F+1]-B[F])/K[F]-K[F]*(J[F+1][0]+2*J[F][0])/3,M[F]=(J[F+1][0]-J[F][0])/(3*K[F]);for(F=0;F<D&&!(A[F]>C);F++);return F-=1,B[F]+(C-A[F])*L[F]+v.sq(C-A[F])*J[F]+(C-A[F])*v.sq(C-A[F])*M[F]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(A){for(var F,G,B=A.length,C=A[0].length,E=0,H=[],I=[],J=[],K=[],L=[],M=[],N=[],O=[],P=[],Q=[],E=0;E<B;E++)H[E]=v.sum(A[E])/C;for(var E=0;E<C;E++)for(N[E]=[],F=0;F<B;F++)N[E][F]=A[F][E]-H[F];N=v.transpose(N);for(var E=0;E<B;E++)for(O[E]=[],F=0;F<B;F++)O[E][F]=v.dot([N[E]],[N[F]])/(C-1);J=v.jacobi(O),P=J[0],I=J[1],Q=v.transpose(P);for(var E=0;E<I.length;E++)for(F=E;F<I.length;F++)I[E]<I[F]&&(G=I[E],I[E]=I[F],I[F]=G,K=Q[E],Q[E]=Q[F],Q[F]=K);M=v.transpose(N);for(var E=0;E<B;E++)for(L[E]=[],F=0;F<M.length;F++)L[E][F]=v.dot([Q[E]],[M[F]]);return[A,I,Q,L]}}),function(A){for(var B=0;B<A.length;B++)(function(C){v.fn[C]=function(D,E){var F=this;return E?(setTimeout(function(){E.call(F,v.fn[C].call(F,D))},15),this):"number"==typeof v[C](this,D)?v[C](this,D):v(v[C](this,D))}})(A[B])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(this.jStat,Math),function(v,w){function x(B,C,D,E){if(1<B||1<D||0>=B||0>=D)throw new Error("Proportions should be greater than 0 and less than 1");var F=(B*C+D*E)/(C+E),G=w.sqrt(F*(1-F)*(1/C+1/E));return(B-D)/G}var y=[].slice,z=v.utils.isNumber,A=v.utils.isArray;v.extend({zscore:function(){var B=y.call(arguments);return z(B[1])?(B[0]-B[1])/B[2]:(B[0]-v.mean(B[1]))/v.stdev(B[1],B[2])},ztest:function(){var C,B=y.call(arguments);return A(B[1])?(C=v.zscore(B[0],B[1],B[3]),1===B[2]?v.normal.cdf(-w.abs(C),0,1):2*v.normal.cdf(-w.abs(C),0,1)):2<B.length?(C=v.zscore(B[0],B[1],B[2]),1===B[3]?v.normal.cdf(-w.abs(C),0,1):2*v.normal.cdf(-w.abs(C),0,1)):(C=B[0],1===B[1]?v.normal.cdf(-w.abs(C),0,1):2*v.normal.cdf(-w.abs(C),0,1))}}),v.extend(v.fn,{zscore:function(B,C){return(B-this.mean())/this.stdev(C)},ztest:function(B,C,D){var E=w.abs(this.zscore(B,D));return 1===C?v.normal.cdf(-E,0,1):2*v.normal.cdf(-E,0,1)}}),v.extend({tscore:function(){var B=y.call(arguments);return 4===B.length?(B[0]-B[1])/(B[2]/w.sqrt(B[3])):(B[0]-v.mean(B[1]))/(v.stdev(B[1],!0)/w.sqrt(B[1].length))},ttest:function(){var C,B=y.call(arguments);return 5===B.length?(C=w.abs(v.tscore(B[0],B[1],B[2],B[3])),1===B[4]?v.studentt.cdf(-C,B[3]-1):2*v.studentt.cdf(-C,B[3]-1)):z(B[1])?(C=w.abs(B[0]),1==B[2]?v.studentt.cdf(-C,B[1]-1):2*v.studentt.cdf(-C,B[1]-1)):(C=w.abs(v.tscore(B[0],B[1])),1==B[2]?v.studentt.cdf(-C,B[1].length-1):2*v.studentt.cdf(-C,B[1].length-1))}}),v.extend(v.fn,{tscore:function(B){return(B-this.mean())/(this.stdev(!0)/w.sqrt(this.cols()))},ttest:function(B,C){return 1===C?1-v.studentt.cdf(w.abs(this.tscore(B)),this.cols()-1):2*v.studentt.cdf(-w.abs(this.tscore(B)),this.cols()-1)}}),v.extend({anovafscore:function(){var C,D,E,F,G,H,I,J,B=y.call(arguments);if(1===B.length){G=Array(B[0].length);for(var I=0;I<B[0].length;I++)G[I]=B[0][I];B=G}if(2===B.length)return v.variance(B[0])/v.variance(B[1]);D=[];for(var I=0;I<B.length;I++)D=D.concat(B[I]);E=v.mean(D),C=0;for(var I=0;I<B.length;I++)C+=B[I].length*w.pow(v.mean(B[I])-E,2);C/=B.length-1,H=0;for(var I=0;I<B.length;I++)for(F=v.mean(B[I]),J=0;J<B[I].length;J++)H+=w.pow(B[I][J]-F,2);return H/=D.length-B.length,C/H},anovaftest:function(){var C,D,E,F,B=y.call(arguments);if(z(B[0]))return 1-v.centralF.cdf(B[0],B[1],B[2]);anovafscore=v.anovafscore(B),C=B.length-1,E=0;for(var F=0;F<B.length;F++)E+=B[F].length;return D=E-C-1,1-v.centralF.cdf(anovafscore,C,D)},ftest:function(B,C,D){return 1-v.centralF.cdf(B,C,D)}}),v.extend(v.fn,{anovafscore:function(){return v.anovafscore(this.toArray())},anovaftes:function(){for(var C,B=0,C=0;C<this.length;C++)B+=this[C].length;return v.ftest(this.anovafscore(),this.length-1,B-this.length)}}),v.extend({normalci:function(){var D,B=y.call(arguments),C=[,,];return D=4===B.length?w.abs(v.normal.inv(B[1]/2,0,1)*B[2]/w.sqrt(B[3])):w.abs(v.normal.inv(B[1]/2,0,1)*v.stdev(B[2])/w.sqrt(B[2].length)),C[0]=B[0]-D,C[1]=B[0]+D,C},tci:function(){var D,B=y.call(arguments),C=[,,];return D=4===B.length?w.abs(v.studentt.inv(B[1]/2,B[3]-1)*B[2]/w.sqrt(B[3])):w.abs(v.studentt.inv(B[1]/2,B[2].length-1)*v.stdev(B[2],!0)/w.sqrt(B[2].length)),C[0]=B[0]-D,C[1]=B[0]+D,C},significant:function(B,C){return B<C}}),v.extend(v.fn,{normalci:function(B,C){return v.normalci(B,C,this.toArray())},tci:function(B,C){return v.tci(B,C,this.toArray())}}),v.extend(v.fn,{oneSidedDifferenceOfProportions:function(B,C,D,E){var F=x(B,C,D,E);return v.ztest(F,1)},twoSidedDifferenceOfProportions:function(B,C,D,E){var F=x(B,C,D,E);return v.ztest(F,2)}})}(this.jStat,Math),this.jStat.models=function(){function v(v,B){return w(A,B)}function v(){var B=A[0].length,C=jStat.arange(B).map(function(D){var E=jStat.arange(B).filter(function(F){return F!==D});return w(jStat.col(A,D).map(function(F){return F[0]}),jStat.col(A,E))});return C}function w(A,B){var C=A.length,D=B[0].length-1,F=jStat.lstsq(B,A),G=jStat.multiply(B,F.map(function(N){return[N]})).map(function(N){return N[0]}),H=jStat.subtract(A,G),I=jStat.mean(A),J=jStat.sum(G.map(function(N){return _Mathpow(N-I,2)})),K=jStat.sum(A.map(function(N,O){return _Mathpow(N-G[O],2)})),L=J+K;return{exog:B,endog:A,nobs:C,df_model:D,df_resid:C-D-1,coef:F,predict:G,resid:H,ybar:I,SST:L,SSE:J,SSR:K,R2:J/L}}function x(A){var B=v(A.exog),C=_Mathsqrt(A.SSR/A.df_resid),D=B.map(function(I){var J=I.SST,K=I.R2;return C/_Mathsqrt(J*(1-K))}),E=A.coef.map(function(I,J){return(I-0)/D[J]}),F=E.map(function(I){var J=jStat.studentt.cdf(I,A.df_resid);return 2*(.5<J?1-J:J)}),G=jStat.studentt.inv(.975,A.df_resid),H=A.coef.map(function(I,J){var K=G*D[J];return[I-K,I+K]});return{se:D,t:E,p:F,sigmaHat:C,interval95:H}}function y(A){var B=A.R2/A.df_model/((1-A.R2)/A.df_resid),D=1-function(E,F,G){return jStat.beta.cdf(E/(G/F+E),F/2,G/2)}(B,A.df_model,A.df_resid);return{F_statistic:B,pvalue:D}}return{ols:function(A,B){var C=w(A,B),D=x(C),E=y(C),F=1-(1-C.rsquared)*((C.nobs-1)/C.df_resid);return C.t=D,C.f=E,C.adjust_R2=F,C}}}();</script>

<script>(function(){class a extends Polymer.Element{static get is(){return'stat-poisson'}static get properties(){return{lambda:{type:Number,notify:!0},probability:{type:Number},statInfo:{type:Object,computed:'_computeStatInfo(lambda)',notify:!0}}}_computeStatInfo(b){b=+b;let c=b,d=b,e=Math.sqrt(d);return{mean:c.toFixed(2),variance:d.toFixed(2),std:e.toFixed(2)}}pdf(b){let c=+this.lambda;return window.jStat.poisson.pdf(b,c)}cdf(b){let c=+this.lambda;return window.jStat.poisson.cdf(b,c)}computeProbability(b,c,d){switch(b){case'lt':return this.cdf(c);case'gt':return 1-this.cdf(c-1);case'between':if(c>d)return 0;let e=this.cdf(c-1),f=1-this.cdf(d);return 1-e-f;default:return 0;}}createDistributionData(){let b=+this.lambda,c=[];for(let e,d=0;e=this.pdf(d),!(d>2*b&&1e-3>e);d++)c.push({x:d,y:e});return c}}customElements.define(a.is,a)})();</script>
</div><dom-module id="d-poisson-distribution">
  <template>
    <style include="distribution-style"></style>
    <style>
      :host {
        display: block;
      }
    </style>

    <stat-poisson id="statPoisson" lambda="[[distributionMean]]" stat-info="{{statInfo}}"></stat-poisson>

    <d-distribution-layout id="distributionLayout" stat-info="[[statInfo]]" on-x-setting-data-changed="_handleXSettingDataChanged" discrete="">
      <div slot="setting" id="setting" class="setting">
        <paper-input id="meanInput" label="Mean" type="number" value="{{distributionMean}}" error-message="均值必须为非负数"></paper-input>
      </div>

      <div slot="reference" id="reference" class="reference">
        <h2 class="title">泊松分布
          <a href="https://zh.wikipedia.org/wiki/%E6%B3%8A%E6%9D%BE%E5%88%86%E4%BD%88" class="wiki">维基百科</a>
        </h2>
        <p>泊松分布（Poisson distribution），适合于描述单位时间内随机事件发生的次数的离散型概率分布。</p>
        <h3>Mean:</h3>
        <d-katex tex="\mu = E(X) = \lambda"></d-katex>
        <h3>Variance:</h3>
        <d-katex tex="\sigma^2 = Var(X) = \lambda"></d-katex>
        <h3>PMF:</h3>
        <d-katex tex="P(X = x) = \frac {\lambda^xe^{-\lambda} } {x!}"></d-katex>
      </div>
  </d-distribution-layout></template>
  <script>(function(){'use strict';class a extends Polymer.Element{static get is(){return'd-poisson-distribution'}static get properties(){return{distributionMean:{value:3,type:Number,notify:!0}}}static get observers(){return['_redraw(distributionMean)']}_redraw(b){let c=+b;if(c!==this._oldMean)return this._oldMean=c,this.$.meanInput.invalid=!1,0>c?void(this.$.meanInput.invalid=!0):void(this.$.distributionLayout.distributionData=this.$.statPoisson.createDistributionData())}_handleXSettingDataChanged(b){let c=b.target.xSettingData;c&&(this.$.distributionLayout.selectedProbability=this.$.statPoisson.computeProbability(c.rangeType,c.x1,c.x2).toFixed(3))}}customElements.define(a.is,a)})();</script>
</dom-module>
